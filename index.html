<script>
    // 1. CONFIGURACIÓN DEL SERVIDOR
    const USUARIO = "sanchezrodriguezdannyjose-byte"; 
    const REPOSITORIO = "TAROT";
    const BaseURL = `https://${USUARIO}.github.io/${REPOSITORIO}/cards/`;

    // 2. LISTA DE CARTAS (Del 0 al 77)
    const nombresArchivos = Array.from({length: 78}, (_, i) => `${i}.jpg`);

    let seleccionadas = [];

    // 3. FUNCIÓN PARA BARAJEAR
    async function mezclar() {
        const log = document.getElementById('log');
        const btnI = document.getElementById('btn-invocar');
        log.innerText = "Sincronizando mazo...";
        log.style.color = "#f1c40f";

        let mazo = [...nombresArchivos].sort(() => Math.random() - 0.5);
        let elegidas = mazo.slice(0, 10);
        seleccionadas = [];

        // Limpiar mesa
        document.querySelectorAll('.slot').forEach(s => {
            s.innerHTML = ''; 
            s.classList.add('is-back');
            s.classList.remove('glow-final');
        });

        // Cargar imágenes desde GitHub
        for(let i=0; i<10; i++) {
            const img = new Image();
            img.src = BaseURL + elegidas[i] + "?v=" + Date.now();
            await new Promise(res => {
                img.onload = () => { seleccionadas[i] = img; res(); };
                img.onerror = () => { res(); };
            });
        }
        log.innerText = "Mazo listo. Inicia la invocación.";
        log.style.color = "#2ecc71";
        btnI.disabled = false;
    }

    // 4. FUNCIÓN PARA INVOCAR (MOSTRAR CARTAS)
    async function lanzar() {
        document.getElementById('btn-invocar').disabled = true;
        for(let i=0; i<10; i++) {
            const s = document.getElementById(`s${i}`);
            if(seleccionadas[i]) {
                s.appendChild(seleccionadas[i]);
                seleccionadas[i].style.display = "block";
            }
            s.classList.remove('is-back');
            if(i === 9) s.classList.add('glow-final');
            await new Promise(r => setTimeout(r, 600));
        }
    }

    // 5. AJUSTE DE PANTALLA
    function ajustar() {
        const mesa = document.getElementById('mesa');
        const cont = document.querySelector('.viewport-fix');
        if(!mesa || !cont) return;
        const escala = Math.min(cont.clientWidth / 680, cont.clientHeight / 580);
        mesa.style.transform = `scale(${escala * 0.95})`;
    }
    window.onload = ajustar;
    window.onresize = ajustar;
</script>
